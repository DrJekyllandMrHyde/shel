/*

 This file is part of Baus.js (acronym for Browser Access Unix Shell)
 Copyright (C) 2013  Jakub Jankiewicz <http://jcubic.pl>

 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.

*/
var baus={version:"0.1"};
$(function(){var g=$.omap({blue:"#55f",green:"#4d4",grey:"#999"},function(b,d){return function(f){return"[[;"+d+";]"+f+"]"}}),h;rpc({url:"",error:function(b){b=b.error?b.error.message+"\n["+b.error.at+"] "+b.error.line:b.message||b;var d=$.terminal.active();if(d){d.resume();d.error(b)}else alert(b);h&&h(null)}})(function(b){b.installed()(function(d){var f=[" _                        _\n| |__   __ _ _   _ ___   (_)___\n| '_ \\ / _` | | | / __|  | / __|\n| |_) | (_| | |_| \\__ \\_ | \\__ \\\n|_.__/ \\__,_|\\__,_|___(_)/ |___/\n                       |__/","Browser Access Unix Shell"+
(baus.version!="0.1"?"v. "+baus.version:""),""].join("\n"),j=$("body").terminal(function(e,a){if(d)$.terminal.parseCommand(e);else if(e==="install"){a.echo("Type your root password");a.set_mask(true);a.push(function(c){a.pop();a.set_mask(false);a.pause();b.set_root_password(c)(function(){a.resume();a.echo("Your root password has been set")})},{prompt:"password: "})}},{greetings:d?null:f,prompt:d?function(e){var a,c=$.terminal.active().login_name();a=g.green(c+"&#64;???");c=g.grey(c==="root"?"# ":
"$ ");a=a+g.grey(":")+g.blue("~")+c;e(a)}:"> ",onBeforeLogin:function(e){e.echo(f)},onAfterLogin:function(){h=null},outputLimit:200,tabcompletion:true,completion:function(e,a,c){d?c(["help"]):c(["install","help"])},login:d?function(e,a,c){h=c;b.login(e,a)(function(i){c(i)})}:false}).css({overflow:"auto"});$(window).resize(function(){j.css("height",$(window).height()-20)}).resize()})})});
